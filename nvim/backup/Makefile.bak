# Neovim Literate Configuration Makefile

.PHONY: help tangle clean stow unstow

# Default target
help: ## Show this help message
	@echo "Available commands:"
	@echo ""
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | \
		awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-10s\033[0m %s\n", $$1, $$2}'

tangle: ## Extract configuration files from README.md
	@echo "Tangling configuration from README.md..."
	@lua tangle.lua

clean: ## Remove generated configuration files
	@echo "Cleaning generated configuration files..."
	@rm -f init.lua
	@rm -rf lua/
	@echo "Cleaned: init.lua and lua/ directory"

stow: ## Create symlinks using GNU stow with custom target
	@echo "Creating symlinks with stow..."
	@cd .. && stow --target="$(HOME)/.config/nvim" nvim
	@echo "Symlinks created: ~/.config/nvim/* -> $(PWD)/*"

unstow: ## Remove symlinks created by stow
	@echo "Removing symlinks with stow..."
	@cd .. && stow -D --target="$(HOME)/.config/nvim" nvim
	@echo "Symlinks removed"
